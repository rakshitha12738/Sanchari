<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Travel Guide</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    :root {
      /* Color Palette matching index.html */
      --primary: #6366F1;
      --primary-light: #818CF8;
      --primary-dark: #4F46E5;
      --secondary: #F59E0B;
      --accent: #EC4899;
      
      /* Backgrounds */
      --bg-gradient-start: #F0F9FF;
      --bg-gradient-end: #FEF3C7;
      --glass-bg: rgba(255, 255, 255, 0.85);
      --glass-border: rgba(255, 255, 255, 0.5);
      
      /* Text */
      --text-primary: #1E293B;
      --text-secondary: #64748B;
      
      /* Shadows */
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.12);
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
      background-attachment: fixed;
      color: var(--text-primary);
      overflow-x: hidden;
      scroll-behavior: smooth;
      -webkit-font-smoothing: antialiased;
    }
    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.08) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2.5rem;
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--glass-border);
      box-shadow: var(--shadow-md);
      z-index: 1000;
      transition: background 0.3s ease;
    }
    
    nav.scrolled { 
      background: rgba(255, 255, 255, 0.95); 
    }

    nav h1 { 
      color: var(--primary); 
      font-size: 1.5rem; 
      letter-spacing: 1px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 700;
    }

    .nav-links {
      display: flex;
      gap: 2rem;
    }
    
    .nav-links a {
      color: var(--text-primary);
      text-decoration: none;
      font-weight: 500;
      font-size: 0.95rem;
      transition: color 0.3s;
      position: relative;
    }
    
    .nav-links a::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      transition: width 0.3s ease;
    }
    
    .nav-links a:hover { 
      color: var(--primary); 
    }
    
    .nav-links a:hover::after {
      width: 100%;
    }

    .menu-toggle {
      display: none;
      flex-direction: column;
      cursor: pointer;
      background: none;
      border: none;
    }
    
    .menu-toggle span {
      height: 3px; 
      width: 25px; 
      background: var(--primary); 
      margin: 4px 0; 
      border-radius: 5px;
      transition: all 0.3s ease;
    }

    @media (max-width: 768px) {
      nav {
        padding: 1rem 1.5rem;
      }
      
      .nav-links {
        position: absolute;
        top: 70px;
        left: 0;
        width: 100%;
        flex-direction: column;
        background: var(--glass-bg);
        backdrop-filter: blur(10px);
        padding: 1.5rem;
        gap: 1rem;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.4s ease;
        box-shadow: var(--shadow-lg);
      }
      
      .nav-links.open { 
        max-height: 400px; 
      }
      
      .menu-toggle { 
        display: flex; 
      }
    }

    header {
      height: 50vh;
      min-height: 400px;
      background-image: url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1600&q=80');
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: #fff;
      position: relative;
      margin-top: 70px;
    }

    header::after {
      content: '';
      position: absolute;
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.6) 0%, rgba(236, 72, 153, 0.4) 100%);
      z-index: 0;
    }

    header h1, header p {
      position: relative;
      z-index: 1;
      opacity: 0;
      transform: translateY(30px);
      animation: fadeUp 0.8s forwards;
    }
    
    header h1 { 
      font-size: 2.8rem; 
      animation-delay: 0.2s;
      font-weight: 700;
      text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
    }
    
    header p { 
      font-size: 1.15rem; 
      margin-top: 0.75rem; 
      animation-delay: 0.4s;
      font-weight: 300;
      max-width: 600px;
      line-height: 1.6;
    }

    @keyframes fadeUp {
      to { opacity: 1; transform: translateY(0); }
    }

    .summary-section {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);
      padding: 5rem 2rem;
      text-align: center;
      position: relative;
      z-index: 1;
    }
    
    .summary-section h2 {
      font-size: 2.5rem;
      color: var(--text-primary);
      margin-bottom: 3rem;
      font-weight: 600;
    }

    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      max-width: 1200px;
      margin: 0 auto;
    }

    .card {
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      color: var(--text-primary);
      border-radius: 1rem;
      padding: 2.5rem 2rem;
      box-shadow: var(--shadow-md);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .card h3 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: var(--text-primary);
    }
    
    .card p {
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 1.5rem;
    }

    .card button {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: #fff;
      border: none;
      padding: 0.75rem 1.75rem;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: 500;
      font-size: 0.95rem;
      box-shadow: var(--shadow-sm);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .card button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .section {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      gap: 4rem;
      padding: 5rem 2.5rem;
      max-width: 1200px;
      margin: 0 auto;
      opacity: 0;
      transform: translateY(40px);
      transition: all 0.8s ease;
      position: relative;
      z-index: 1;
    }
    
    .section.visible { 
      opacity: 1; 
      transform: translateY(0); 
    }

    .section:nth-child(even) { 
      background-color: transparent;
    }

    .section img {
      width: 100%;
      max-width: 500px;
      border-radius: 1.5rem;
      box-shadow: var(--shadow-lg);
      object-fit: cover;
      height: 350px;
    }

    .text { 
      max-width: 500px; 
    }
    
    .text h2 { 
      font-size: 2.2rem; 
      color: var(--text-primary); 
      margin-bottom: 1.5rem;
      font-weight: 600;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .text p { 
      color: var(--text-secondary); 
      line-height: 1.8;
      font-size: 1.05rem;
    }
    
    @media (max-width: 768px) {
      header h1 {
        font-size: 2.5rem;
      }
      
      header p {
        font-size: 1.1rem;
      }
      
      .summary-section {
        padding: 3rem 1.5rem;
      }
      
      .summary-section h2 {
        font-size: 2rem;
      }
      
      .section {
        padding: 3rem 1.5rem;
        gap: 2rem;
      }
      
      .text h2 {
        font-size: 1.8rem;
      }
      
      .section img {
        max-width: 100%;
        height: 280px;
      }
    }
  </style>
</head>
<body>
  <nav>
    <h1>SANCHARI</h1>
    <div class="menu-toggle" onclick="toggleMenu()">
      <span></span><span></span><span></span>
    </div>
    <div class="nav-links">
      <a href="index.html">üè† Home</a>
      <a href="#section1">History</a>
      <a href="#section2">Food</a>
      <a href="#section3">Adventure</a>
      <a href="#section4">Safety</a>
      <a href="#section5">Attractions</a>
      <a href="#" id="loginBtn">Login</a>
    </div>
  </nav>

  <header>
    <h1>Discover the World</h1>
    <p>Explore breathtaking places, flavors, and adventures across the globe.</p>
  </header>

  <section class="summary-section">
    <h2>At First Look</h2>
    <div class="cards">
      <div class="card"><h3>üèõÔ∏è History</h3><p>Step back in time and explore ancient wonders.</p><button onclick="scrollToSection(1)">Learn More</button></div>
      <div class="card"><h3>üç≤ Food</h3><p>Taste the culture through every delicious dish.</p><button onclick="scrollToSection(2)">Learn More</button></div>
      <div class="card"><h3>üåÑ Adventure</h3><p>Thrills and explorations that spark your soul.</p><button onclick="scrollToSection(3)">Learn More</button></div>
      <div class="card"><h3>üõ°Ô∏è Safety</h3><p>Smart tips for safe, stress-free travel.</p><button onclick="scrollToSection(4)">Learn More</button></div>
    </div>
  </section>

  <section class="section" id="section1">
    <img src="https://images.unsplash.com/photo-1528909514045-2fa4ac7a08ba?auto=format&fit=crop&w=800&q=80" alt="History" />
    <div class="text">
      <h2>Rich History</h2>
      <p>Every destination holds centuries of stories. Walk through ancient ruins and feel the heartbeat of civilizations that shaped our world.</p>
    </div>
  </section>

  <section class="section" id="section2">
    <div class="text">
      <h2>World of Flavors</h2>
      <p>From spicy street foods to elegant global cuisines, explore the tastes that define every culture. Each dish tells a story of tradition and creativity.</p>
    </div>
    <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=800&q=80" alt="Food" />
  </section>

  <section class="section" id="section3">
    <img src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=800&q=80" alt="Adventure" />
    <div class="text">
      <h2>Adventure Awaits</h2>
      <p>Embrace your inner explorer. Whether hiking, diving, or paragliding, adventure connects you to the planet‚Äôs pulse and makes you feel alive.</p>
    </div>
  </section>

  <section class="section" id="section4">
    <div class="text">
      <h2>Travel Smart & Safe</h2>
      <p>Safety ensures joyful journeys. Stay mindful, respect customs, and keep essential contacts handy wherever you go.</p>
    </div>
    <img src="https://images.unsplash.com/photo-1556740749-887f6717d7e4?auto=format&fit=crop&w=800&q=80" alt="Safety Tips" />
  </section>

  <section class="section" id="section5">
    <img src="https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?auto=format&fit=crop&w=800&q=80" alt="Nearby Attractions" />
    <div class="text">
      <h2>Nearby Attractions</h2>
      <p>Every journey unveils hidden gems just around the corner. Discover nearby attractions ‚Äî serene lakes, local markets, historical landmarks, and breathtaking viewpoints that make your trip unforgettable.</p>
    </div>
  </section>

    <!-- User Menu -->
    <div id="userMenu" style="display: none; position: fixed; right: 20px; top: 70px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); z-index: 1000;">
        <div style="padding: 15px; border-bottom: 1px solid #eee;">
            <strong id="userDisplayName"></strong>
        </div>
        <div style="padding: 15px;">
            <a href="#" onclick="handleLogout()" style="color: var(--primary); text-decoration: none;">Logout</a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.1/js.cookie.min.js"></script>
    <script>
    // Check authentication on page load
    window.addEventListener('DOMContentLoaded', () => {
        const token = Cookies.get('token');
        if (!token) {
            // User is not logged in, redirect to login page
            window.location.href = 'login.html';
            return;
        }
        // User is logged in, show user name in navbar
        updateNavbarUser();
        
        // Load page content
        loadStates().then(() => {
            updateContent();
        });
    });

    function updateNavbarUser() {
        const userName = Cookies.get('userName');
        const loginBtn = document.getElementById('loginBtn');
        if (userName && loginBtn) {
            loginBtn.textContent = userName;
            loginBtn.onclick = function(e) {
                e.preventDefault();
                const userMenu = document.getElementById('userMenu');
                userMenu.style.display = userMenu.style.display === 'none' ? 'block' : 'none';
            };
            
            const userDisplayName = document.getElementById('userDisplayName');
            if (userDisplayName) {
                userDisplayName.textContent = userName;
            }
        }
    }

    function handleLogout() {
        Cookies.remove('token');
        Cookies.remove('userName');
        Cookies.remove('userEmail');
        window.location.href = 'login.html';
    }

    // Close user menu when clicking outside
    document.addEventListener('click', function(event) {
        const userMenu = document.getElementById('userMenu');
        const loginBtn = document.getElementById('loginBtn');
        if (userMenu && loginBtn && !userMenu.contains(event.target) && event.target !== loginBtn) {
            userMenu.style.display = 'none';
        }
    });

    let cityData = null;
    let statesData = [];

    // Fetch city data from API
    async function loadCityData(cityName) {
      try {
        console.log('Fetching city data for:', cityName);
        const response = await fetch(`/api/city/${encodeURIComponent(cityName)}`);
        if (response.ok) {
          cityData = await response.json();
          console.log('City data loaded:', cityData);
          updatePageWithCityData();
        } else {
          console.error('City not found, status:', response.status);
          const errorData = await response.json();
          console.error('Error details:', errorData);
        }
      } catch (error) {
        console.error('Error loading city:', error);
      }
    }

    // Update page with city-specific content
    function updatePageWithCityData() {
      if (!cityData) return;

      // Update header
      document.querySelector('header h1').textContent = `Discover ${cityData.name}`;
      document.querySelector('header p').textContent = cityData.description;

      // Update summary cards
      const cards = document.querySelectorAll('.cards .card');
      if (cards.length >= 4) {
        cards[0].querySelector('p').textContent = cityData.history || 'Rich heritage and culture';
        cards[1].querySelector('p').textContent = `Taste local delicacies: ${cityData.food ? cityData.food.join(', ') : 'Local cuisine'}`;
        cards[2].querySelector('p').textContent = `Activities: ${cityData.activities ? cityData.activities.join(', ') : 'Adventure awaits'}`;
        cards[3].querySelector('p').textContent = `Safety: ${cityData.safety || 'Generally safe'}`;
      }

      // Update sections
      const sections = document.querySelectorAll('.section');
      
      // Section 1: History
      if (sections[0]) {
        const img = sections[0].querySelector('img');
        if (cityData.image && img) {
          img.src = cityData.image;
          img.alt = cityData.name + ' - History';
          img.onerror = function() {
            this.src = 'https://images.unsplash.com/photo-1528909514045-2fa4ac7a08ba?auto=format&fit=crop&w=800&q=80';
          };
        }
        const text = sections[0].querySelector('.text p');
        if (text) {
          text.textContent = cityData.details || cityData.description;
        }
      }

      // Section 2: Food
      if (sections[1]) {
        const img = sections[1].querySelector('img');
        if (img && cityData.image) {
          img.src = cityData.image;
          img.alt = cityData.name + ' - Food';
          img.onerror = function() {
            this.src = 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=800&q=80';
          };
        }
        const text = sections[1].querySelector('.text');
        if (text && cityData.food) {
          text.querySelector('p').textContent = `Must-try dishes: ${cityData.food.join(', ')}`;
        }
      }

      // Section 3: Adventure
      if (sections[2]) {
        const img = sections[2].querySelector('img');
        if (img && cityData.image) {
          img.src = cityData.image;
          img.alt = cityData.name + ' - Adventure';
          img.onerror = function() {
            this.src = 'https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=800&q=80';
          };
        }
        const text = sections[2].querySelector('.text');
        if (text && cityData.activities) {
          text.querySelector('p').textContent = `Top activities: ${cityData.activities.join(', ')}`;
        }
      }

      // Section 4: Safety
      if (sections[3]) {
        const img = sections[3].querySelector('img');
        if (img && cityData.image) {
          img.src = cityData.image;
          img.alt = cityData.name + ' - Safety';
          img.onerror = function() {
            this.src = 'https://images.unsplash.com/photo-1556740749-887f6717d7e4?auto=format&fit=crop&w=800&q=80';
          };
        }
        const text = sections[3].querySelector('.text');
        if (text) {
          text.querySelector('p').textContent = `Best time to visit: ${cityData.bestTime || 'Year-round'}. Weather: ${cityData.weather || 'Varies by season'}`;
        }
      }

      // Section 5: Attractions
      if (sections[4]) {
        const img = sections[4].querySelector('img');
        if (img && cityData.image) {
          img.src = cityData.image;
          img.alt = cityData.name + ' - Attractions';
          img.onerror = function() {
            this.src = 'https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?auto=format&fit=crop&w=800&q=80';
          };
        }
        const text = sections[4].querySelector('.text');
        if (text && cityData.highlights) {
          text.querySelector('p').textContent = `Must-visit: ${cityData.highlights.join(', ')}`;
        }
      }

      // Update background image
      const header = document.querySelector('header');
      if (header && cityData.image) {
        header.style.backgroundImage = `url('${cityData.image}')`;
        console.log('Updated header background to:', cityData.image);
      }
    }

    // Fetch states data from API
    async function loadStates() {
      try {
        const response = await fetch('/api/states');
        statesData = await response.json();
        console.log('Loaded states:', statesData.length);
      } catch (error) {
        console.error('Error loading states:', error);
      }
    }

    // Update content dynamically based on URL parameters
    function updateContent() {
      const urlParams = new URLSearchParams(window.location.search);
      const cityName = urlParams.get('city');
      const stateName = urlParams.get('state');
      
      if (cityName) {
        // Load city-specific data
        loadCityData(cityName);
      } else if (stateName && statesData.length > 0) {
        const state = statesData.find(s => 
          s.name.toLowerCase() === stateName.toLowerCase()
        );
        
        if (state) {
          // Update page content with state-specific data
          document.querySelector('header h1').textContent = `Discover ${state.name}`;
          document.querySelector('header p').textContent = state.description;
          
          if (state.image) {
            const header = document.querySelector('header');
            if (header) {
              header.style.backgroundImage = `url('${state.image}')`;
            }
          }
        }
      }
    }

    function scrollToSection(num) {
      document.getElementById(`section${num}`).scrollIntoView({ behavior: 'smooth' });
    }

    function toggleMenu() {
      document.querySelector('.nav-links').classList.toggle('open');
    }

    const nav = document.querySelector('nav');
    window.addEventListener('scroll', () => {
      nav.classList.toggle('scrolled', window.scrollY > 50);
    });

    const sections = document.querySelectorAll('.section');
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.2 });

    sections.forEach(section => observer.observe(section));
  </script>
</body>
</html>